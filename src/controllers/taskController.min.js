const Task=require("../models/task"),sendEmails=require("../middleware/nodemailer");function taskController(){return{async postTask(req,res){try{const pussedImages=[],multipleEmail=[];if(req.body.email&&(console.log("hii"),req.body.email.map(email=>{multipleEmail.push(email)})),req.body.files){const fileGet=req.files.map(file=>{pussedImages.push(file.filename),console.log(pussedImages)})}const createTask=new Task({title:req.body.title,description:req.body.description,completed:req.body.completed,important:req.body.important,assignee:req.body.assignee,subTask:req.body.subTask,topic:req.body.subTask,email:multipleEmail,path:"/image",image:pussedImages});await createTask.save(),res.status(201).send({sucess:!0,message:"Task created successfully",data:createTask});let convertEmailToString=multipleEmail.toString();console.log(convertEmailToString);let subject={title:createTask.title,description:createTask.description};sendEmails(convertEmailToString,`You Have Been assgined a new Task by ${createTask.assignee}`,`Title :${createTask.title} \n Description : ${createTask.description}`)}catch(error){console.log(error),res.status(500).send({sucess:!1,message:"Not Able to Create Tasks"})}}}}module.exports=taskController;